# Sparse file

稀疏文件（英语：sparse file）是一种计算机文件，它能尝试在文件内容大多为空时更有效率地使用文件系统的空间。它的原理是以简短的信息（元数据）表示空数据块，而不是在在磁盘上占用实际空间来存储空数据块。只有真实（非空）的数据块会按原样写入磁盘。

在读取稀疏文件时，文件系统会按元数据在运行时将这些透明转换为“真实”的数据块，即填充为零。应用程序不会察觉这个转换。

大多数现代的文件系统支持稀疏文件，包括大多数Unix变种和NTFS。[1]苹果的HFS+不提供稀疏文件支持，但在OS X中，虚拟文件系统层支持在任何受支持文件系统中存储稀疏文件，包括HFS+。2016年6月在WWDC宣布的苹果文件系统（APFS[2]）支持稀疏文件。稀疏文件常被用在磁盘映像、数据库快照、日志文件和科学应用中。

<https://zh.wikipedia.org/wiki/%E7%A8%80%E7%96%8F%E6%96%87%E4%BB%B6>

<https://wiki.archlinux.org/title/Sparse_file>

## 使用 tar 存档

tar 有一个 '--sparse' （'-S'） 标志，当与 '--create' （'-c'） 操作结合使用时，它会在存档时测试所有文件的稀疏性。如果 tar 发现某个文件是稀疏的，它会使用存档中文件的稀疏表示形式。这在存档文件（如 dbm 文件）时非常有用，可能包含许多空值，并大大减少了存储此类存档所需的空间量。

